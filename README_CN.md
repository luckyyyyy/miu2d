# Miu2D Engine

åŸºäº Web æŠ€æœ¯çš„ 2D RPG æ¸¸æˆå¼•æ“ã€‚

## ğŸ“– å…³äºæœ¬é¡¹ç›®

**Miu2D** æ˜¯ä¸€ä¸ªä½¿ç”¨ **TypeScript + React + WebGL** æŠ€æœ¯æ„å»ºçš„ 2D RPG æ¸¸æˆå¼•æ“ï¼Œä¸“ä¸º Web å¹³å°è®¾è®¡ã€‚

### ğŸ® Demoï¼šæœˆå½±ä¼ è¯´ Web å¤åˆ»ç‰ˆ

ğŸŒ **åœ¨çº¿æ¼”ç¤º**ï¼š[https://miu2d.com](https://miu2d.com)

ä½œä¸ºå¼•æ“çš„æ¼”ç¤ºé¡¹ç›®ï¼Œæˆ‘ä»¬å¤åˆ»äº†**è¥¿å±±å±… 2001 å¹´**æ¨å‡ºçš„ç»å…¸å•æœº RPGã€Šå‰‘ä¾ æƒ…ç¼˜å¤–ä¼ ï¼šæœˆå½±ä¼ è¯´ã€‹ã€‚

åŸå§‹æ¸¸æˆä½¿ç”¨ C++ å¼€å‘ï¼Œåæ¥æœ‰ç©å®¶ç”¨ C# + XNA æ¡†æ¶è¿›è¡Œäº†å¤åˆ»ï¼ˆ[JxqyHD](https://github.com/mapic91/JxqyHD)ï¼‰ï¼Œæœ¬é¡¹ç›®åœ¨æ­¤åŸºç¡€ä¸Šå°†æ¸¸æˆç§»æ¤åˆ° Web å¹³å°ï¼Œè®©ç»å…¸æ¸¸æˆèƒ½åœ¨æµè§ˆå™¨ä¸­è¿è¡Œã€‚

> ğŸ¨ **Vibe Coding Project** - æœ¬é¡¹ç›®é‡‡ç”¨çº¯ vibe coding æ–¹å¼å¼€å‘ï¼Œå€ŸåŠ© AI è¾…åŠ©ç¼–ç¨‹ï¼Œäº«å—ç¼–ç çš„ä¹è¶£ï¼

> ğŸ“± **åŸç”Ÿç§»åŠ¨ç«¯æ”¯æŒ** - å®Œç¾é€‚é…æ‰‹æœºå’Œå¹³æ¿ï¼Œè™šæ‹Ÿæ‘‡æ† + è§¦æ§äº¤äº’ï¼Œéšæ—¶éšåœ°é‡æ¸©ç»å…¸æ­¦ä¾ ï¼

### ğŸ–¥ï¸ æ¡Œé¢ç‰ˆ

![æ¸¸æˆæˆªå›¾](packages/web/public/screenshot/screenshot.png)

### ğŸ“± ç§»åŠ¨ç«¯

![ç§»åŠ¨ç«¯æˆªå›¾](packages/web/public/screenshot/mobile.png)

### ğŸ› ï¸ å†…ç½®ç¼–è¾‘å™¨

**åœ°å›¾ç¼–è¾‘å™¨** - å¯è§†åŒ–ç“¦ç‰‡åœ°å›¾ç¼–è¾‘ã€å›¾å±‚ç®¡ç†ã€ç¢°æ’åŒºåŸŸè®¾ç½®

![åœ°å›¾ç¼–è¾‘å™¨](packages/web/public/screenshot/map-editor.png)

**ASF ç¼–è¾‘å™¨** - ç²¾çµåŠ¨ç”»å¸§æŸ¥çœ‹å™¨å’Œè°ƒè¯•å·¥å…·

![ASF ç¼–è¾‘å™¨](packages/web/public/screenshot/asf-editor.png)

### ğŸ® æ¸¸æˆç‰¹è‰²

ã€Šå‰‘ä¾ æƒ…ç¼˜å¤–ä¼ ï¼šæœˆå½±ä¼ è¯´ã€‹æ˜¯è¥¿å±±å±…åœ¨å‰‘ä¾ æƒ…ç¼˜ç³»åˆ—åŸºç¡€ä¸Šæ¨å‡ºçš„å¤–ä¼ ä½œå“ï¼Œè®²è¿°äº†æ¨å½±æ«çš„æˆé•¿æ•…äº‹ï¼š

- ğŸ—ºï¸ **æ­¦ä¾ ä¸–ç•Œæ¢ç´¢** - å‡Œç»å³°ã€æ­¦å½“å±±ã€æƒ å®‰é•‡ç­‰ç»å…¸åœºæ™¯
- âš”ï¸ **å³æ—¶æˆ˜æ–—ç³»ç»Ÿ** - å‰‘æ³•ã€å†…åŠŸã€è½»åŠŸçš„ç»„åˆè¿ç”¨
- ğŸ§™ **æ­¦å­¦æŠ€èƒ½** - ä¸°å¯Œçš„æ­¦åŠŸæ‹›å¼å’Œå†…åŠŸå¿ƒæ³•
- ğŸ’¬ **å‰§æƒ…ä»»åŠ¡** - è·Ÿéšä¸»è§’æ¨å½±æ«å±•å¼€æ­¦ä¾ å†’é™©
- ğŸ’ **è£…å¤‡ç³»ç»Ÿ** - æ”¶é›†è£…å¤‡å’Œé“å…·æå‡æˆ˜åŠ›
- ğŸµ **åŸç‰ˆéŸ³ä¹** - ä¿ç•™ç»å…¸é…ä¹å’ŒéŸ³æ•ˆ

---

## âœ¨ Demo å®ç°è¿›åº¦

### æ€»ä½“å®Œæˆåº¦ï¼šçº¦ 92%

| ç³»ç»Ÿ | è¿›åº¦ | çŠ¶æ€ | ä¸»è¦æ¨¡å— |
|------|------|------|----------|
| åœ°å›¾æ¸²æŸ“ | 95% | ğŸŸ¢ å¯ç”¨ | map.ts, renderer.ts, mapTrapManager.ts |
| è§’è‰²ç³»ç»Ÿ | 90% | ğŸŸ¢ å¯ç”¨ | character.ts, player.ts, npc.ts, npcManager.ts |
| ç²¾çµåŠ¨ç”» | 95% | ğŸŸ¢ å¯ç”¨ | sprite.ts, asf.tsï¼ˆæ”¯æŒçŸ³åŒ–/å†»ç»“/ä¸­æ¯’ç€è‰²ï¼‰ |
| å‰§æœ¬ç³»ç»Ÿ | 98% | ğŸŸ¢ å¯ç”¨ | parser.ts, executor.ts, commands/*ï¼ˆ**180+ å‘½ä»¤å¤„ç†å™¨**ï¼‰ |
| ç•Œé¢ç³»ç»Ÿ | 95% | ğŸŸ¢ å¯ç”¨ | guiManager.ts, **29 ä¸ª UI ç»„ä»¶**, DebugPanelï¼ˆ10 ä¸ªæ¨¡å—åŒ–åŒºå—ï¼‰ |
| è¾“å…¥ç³»ç»Ÿ | 95% | ğŸŸ¢ å¯ç”¨ | inputHandler.ts, interactionManager.ts |
| éŸ³æ•ˆç³»ç»Ÿ | 95% | ğŸŸ¢ å¯ç”¨ | audioManager.ts (Web Audio API) |
| ç‰¹æ•ˆç³»ç»Ÿ | 85% | ğŸŸ¢ å¯ç”¨ | screenEffects.ts, æ·¡å…¥æ·¡å‡º/é¢œè‰²æ¸²æŸ“/é—ªå±/æ°´æ³¢çº¹ |
| ç‰©å“ç³»ç»Ÿ | 90% | ğŸŸ¢ å¯ç”¨ | good.ts, goodsListManager.ts |
| ç‰©ä½“ç³»ç»Ÿ | 85% | ğŸŸ¢ å¯ç”¨ | obj.ts, objManager.ts, objRenderer.ts |
| æ­¦åŠŸç³»ç»Ÿ | 90% | ğŸŸ¢ å¯ç”¨ | magicManager.ts, magicSprite.ts, **12 ç§ MoveKind ç‰¹æ•ˆ**, passives/* |
| æˆ˜æ–—ç³»ç»Ÿ | 70% | ğŸŸ¡ éƒ¨åˆ† | magicHandler.ts, specialActionHandler.ts |
| å­˜æ¡£ç³»ç»Ÿ | 90% | ğŸŸ¢ å¯ç”¨ | loader.ts, storage.ts |
| è°ƒè¯•ç³»ç»Ÿ | 95% | ğŸŸ¢ å¯ç”¨ | debugManager.ts, DebugPanel/ï¼ˆ**10 ä¸ªæ¨¡å—åŒ–åŒºå—**ï¼‰ |
| å¯»è·¯ç³»ç»Ÿ | 90% | ğŸŸ¢ å¯ç”¨ | pathFinder.ts (A* ç®—æ³•) |
| å•†åº—ç³»ç»Ÿ | 90% | ğŸŸ¢ å¯ç”¨ | buyManager.ts, BuyGui.tsx |
| å°åœ°å›¾ | 90% | ğŸŸ¢ å¯ç”¨ | LittleMapGui.tsx |
| å¤©æ°”ç³»ç»Ÿ | 85% | ğŸŸ¢ æ–°å¢ | weatherManager.ts, rain.ts, snow.ts |
| è®¡æ—¶å™¨ç³»ç»Ÿ | 90% | ğŸŸ¢ æ–°å¢ | timerManager.ts, TimerGui.tsx |
| è§†é¢‘æ’­æ”¾ | 80% | ğŸŸ¢ æ–°å¢ | VideoPlayer.tsx (HTML5 Video) |
| ä¼™ä¼´ç³»ç»Ÿ | 85% | ğŸŸ¢ æ–°å¢ | partnerList.ts |
| ç§»åŠ¨ç«¯é€‚é… | 95% | ğŸŸ¢ æ–°å¢ | è™šæ‹Ÿæ‘‡æ†ã€è§¦æ§äº¤äº’ã€å“åº”å¼ UI |

**å›¾ä¾‹**: ğŸŸ¢ å¯ç”¨ | ğŸŸ¡ éƒ¨åˆ†/è¿›è¡Œä¸­ | ğŸ”´ æœªå¼€å§‹

### ä»£ç è§„æ¨¡
- **å¼•æ“ä»£ç **: ~47,000 è¡Œ TypeScript
- **ç»„ä»¶ä»£ç **: ~12,000 è¡Œ TSX
- **å‰§æœ¬å‘½ä»¤**: 180+ ä¸ªå‘½ä»¤å¤„ç†å™¨
- **ScriptContext æ¥å£**: 130+ ä¸ªæ–¹æ³•

---

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æŠ€æœ¯æ ˆ

- **è¯­è¨€**: TypeScript 5.9 (strict mode)
- **æ¡†æ¶**: React 19, Vite 7
- **æ¸²æŸ“**: WebGL é«˜æ€§èƒ½æ¸²æŸ“ï¼ˆCanvas 2D å›é€€ï¼‰
- **æ ·å¼**: Tailwind CSS 4
- **éŸ³é¢‘**: Web Audio API (OGG Vorbis)
- **ä»£ç è´¨é‡**: Biome (lint + format)
- **åŒ…ç®¡ç†**: pnpm monorepo

### é¡¹ç›®ç»„æˆ

æœ¬é¡¹ç›®é‡‡ç”¨ **pnpm monorepo** æ¶æ„ï¼ŒåŒ…å«ä¸¤ä¸ªç‹¬ç«‹çš„åŒ…ï¼š

| åŒ…å | ç›®å½• | è¯´æ˜ |
|------|------|------|
| **@miu2d/engine** | `packages/engine/` | çº¯ TypeScript 2D RPG å¼•æ“ï¼Œ**ä¸ä¾èµ– React**ï¼Œå¯ç‹¬ç«‹ä½¿ç”¨ |
| **@miu2d/web** | `packages/web/` | React åº”ç”¨ï¼Œæä¾› UI ç•Œé¢ã€é¡µé¢è·¯ç”±å’Œç”¨æˆ·äº¤äº’ |

**å¯¼å…¥å¼•æ“æ¨¡å—ï¼š**
```typescript
// ä»ä¸»å…¥å£å¯¼å…¥
import { GameEngine, Direction } from "@miu2d/engine";

// ä»å­æ¨¡å—å¯¼å…¥
import { logger } from "@miu2d/engine/core/logger";
import { resourceLoader } from "@miu2d/engine/resource/resourceLoader";
import type { MagicData } from "@miu2d/engine/magic";
```

### æ ¸å¿ƒæ¶æ„

æœ¬é¡¹ç›®é‡‡ç”¨**åˆ†å±‚æ¶æ„**ï¼Œä¸¥æ ¼éµå¾ª C# ç‰ˆæœ¬çš„è®¾è®¡ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    React UI Layer                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  pages/          GameScreen, TitleScreen, Landing    â”‚   â”‚
â”‚  â”‚  components/game/ Game, GameCanvas, GameUI           â”‚   â”‚
â”‚  â”‚  components/ui/   å¯¹è¯æ¡†, èƒŒåŒ…, è£…å¤‡, æ­¦åŠŸ, è°ƒè¯•é¢æ¿ç­‰  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ äº‹ä»¶è®¢é˜… / API è°ƒç”¨
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 GameEngine (å•ä¾‹ - å”¯ä¸€å…¥å£)                  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  GlobalResourceManager (å…¨å±€èµ„æº - åªåŠ è½½ä¸€æ¬¡)         â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ TalkTextList    å¯¹è¯æ–‡æœ¬æ•°æ®                     â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ LevelManager    ç­‰çº§é…ç½®                         â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ MagicExpConfig  æ­¦åŠŸç»éªŒé…ç½®                     â”‚   â”‚
â”‚  â”‚  â””â”€â”€ PartnerList     ä¼™ä¼´åå•                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  æ ¸å¿ƒå­ç³»ç»Ÿ (ç”± GameEngine åˆ›å»ºå’ŒæŒæœ‰)                  â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ AudioManager      éŸ³æ•ˆç®¡ç† (Web Audio API)       â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ ScreenEffects     å±å¹•ç‰¹æ•ˆ (æ·¡å…¥æ·¡å‡º/é¢œè‰²/æ°´æ³¢)   â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ WeatherManager    å¤©æ°”ç³»ç»Ÿ (é›¨/é›ª/é—ªç”µ)          â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ TimerManager      è®¡æ—¶å™¨ç®¡ç† (é™æ—¶ä»»åŠ¡)          â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ ObjManager        ç‰©ä½“ç®¡ç†                       â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ DebugManager      è°ƒè¯•ç³»ç»Ÿ                       â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ MemoListManager   ä»»åŠ¡è®°å½•                       â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ MapTrapManager    åœ°å›¾é™·é˜±                       â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ MapRenderer       åœ°å›¾æ¸²æŸ“                       â”‚   â”‚
â”‚  â”‚  â””â”€â”€ ObjRenderer       ç‰©ä½“æ¸²æŸ“                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  GameManager (æ¸¸æˆé€»è¾‘æ§åˆ¶å™¨)                          â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Player            ç©å®¶è§’è‰²                       â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ NpcManager        NPC ç®¡ç†                       â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ GuiManager        ç•Œé¢çŠ¶æ€ç®¡ç†                   â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ ScriptExecutor    å‰§æœ¬æ‰§è¡Œå™¨ (180+ å‘½ä»¤)         â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ GoodsListManager  ç‰©å“åˆ—è¡¨                       â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ MagicListManager  æ­¦åŠŸåˆ—è¡¨                       â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ MagicManager      æ­¦åŠŸé€»è¾‘å’Œæ¸²æŸ“ (12 ç§ç‰¹æ•ˆ)     â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ InputHandler      è¾“å…¥å¤„ç†                       â”‚   â”‚
â”‚  â”‚  â””â”€â”€ InteractionManager äº¤äº’ç®¡ç†                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  EventEmitter (äº‹ä»¶ç³»ç»Ÿ - å¼•æ“ä¸UIé€šä¿¡)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åˆå§‹åŒ–æµç¨‹

å‚ç…§ C# çš„ `JxqyGame.cs` å’Œ `Loader.cs`ï¼Œåˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š

```typescript
// 1. å¼•æ“åˆå§‹åŒ– (åªæ‰§è¡Œä¸€æ¬¡)
await engine.initialize();
// - åŠ è½½å…¨å±€èµ„æº (TalkTextList, LevelManager, MagicExpç­‰)
// - åˆ›å»ºæ¸²æŸ“å™¨å’Œæ¸¸æˆç®¡ç†å™¨

// 2. æ–°æ¸¸æˆ
await engine.newGame();
// - è¿è¡Œ NewGame.txt è„šæœ¬
// - è„šæœ¬è°ƒç”¨ LoadGame(0) åŠ è½½åˆå§‹å­˜æ¡£

// 3. è¯»å–å­˜æ¡£
await engine.loadGame(saveIndex);
// - æ¸…ç†å½“å‰çŠ¶æ€
// - ä»å­˜æ¡£ç›®å½•åŠ è½½æ•°æ®
```

### è®¾è®¡åŸåˆ™

- **å•ä¸€å…¥å£**ï¼šæ‰€æœ‰å­ç³»ç»Ÿè®¿é—®éƒ½é€šè¿‡ `GameEngine`ï¼Œä¸ä½¿ç”¨å…¨å±€å•ä¾‹å‡½æ•°
- **ä¾èµ–æ³¨å…¥**ï¼šå­ç³»ç»Ÿé€šè¿‡æ„é€ å‡½æ•°æˆ– setter æ¥æ”¶ä¾èµ–
- **äº‹ä»¶é©±åŠ¨**ï¼šå¼•æ“é€šè¿‡ `EventEmitter` é€šçŸ¥ UI å±‚çŠ¶æ€å˜åŒ–
- **åˆ†ç¦»å…³æ³¨**ï¼šå¼•æ“é€»è¾‘ä¸ React æ¸²æŸ“å®Œå…¨åˆ†ç¦»

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
game-jxqy/
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ engine/                  # @miu2d/engine - æ¸¸æˆå¼•æ“ï¼ˆ~47k è¡Œï¼‰
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts         # ä¸»å¯¼å‡ºæ–‡ä»¶
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ core/            # æ ¸å¿ƒæ¨¡å—
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ types.ts     # æ ¸å¿ƒç±»å‹å®šä¹‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ mapTypes.ts  # åœ°å›¾ç›¸å…³ç±»å‹
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ pathFinder.ts # A* å¯»è·¯ç®—æ³•
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ eventEmitter.ts # äº‹ä»¶ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ gameEvents.ts # æ¸¸æˆäº‹ä»¶å®šä¹‰
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ logger.ts    # æ—¥å¿—ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ game/            # æ¸¸æˆç®¡ç†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ gameEngine.ts # å¼•æ“å•ä¾‹ï¼ˆå…¥å£ï¼‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ gameManager.ts # æ¸¸æˆé€»è¾‘æ§åˆ¶å™¨
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ inputHandler.ts # è¾“å…¥å¤„ç†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ loader.ts    # å­˜æ¡£åŠ è½½å™¨
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ storage.ts   # å­˜æ¡£å­˜å‚¨
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ resource/        # èµ„æºç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ map/             # åœ°å›¾ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ sprite/          # ç²¾çµç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ character/       # è§’è‰²ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ player/          # ç©å®¶ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ npc/             # NPC ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ obj/             # ç‰©ä½“ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ script/          # å‰§æœ¬ç³»ç»Ÿï¼ˆ180+ å‘½ä»¤ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ magic/           # æ­¦åŠŸç³»ç»Ÿï¼ˆ12 ç§ç‰¹æ•ˆï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ gui/             # ç•Œé¢çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ audio/           # éŸ³æ•ˆç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ effects/         # å±å¹•ç‰¹æ•ˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ weather/         # å¤©æ°”ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ timer/           # è®¡æ—¶å™¨ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ config/          # é…ç½®ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ constants/       # å¸¸é‡å®šä¹‰
â”‚   â”‚   â”‚   â””â”€â”€ utils/           # å·¥å…·æ¨¡å—
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â””â”€â”€ tsconfig.json
â”‚   â”‚
â”‚   â””â”€â”€ web/                     # @miu2d/web - React åº”ç”¨ï¼ˆ~12k è¡Œï¼‰
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ components/      # React ç»„ä»¶
â”‚       â”‚   â”‚   â”œâ”€â”€ game/        # æ¸¸æˆæ ¸å¿ƒç»„ä»¶
â”‚       â”‚   â”‚   â”‚   â”œâ”€â”€ Game.tsx
â”‚       â”‚   â”‚   â”‚   â”œâ”€â”€ GameCanvas.tsx
â”‚       â”‚   â”‚   â”‚   â””â”€â”€ GameUI.tsx
â”‚       â”‚   â”‚   â”‚
â”‚       â”‚   â”‚   â””â”€â”€ game/ui/     # UI ç»„ä»¶ï¼ˆ29 ä¸ªï¼‰
â”‚       â”‚   â”‚       â”œâ”€â”€ classic/ # ç»å…¸ ASF é£æ ¼
â”‚       â”‚   â”‚       â””â”€â”€ modern/  # ç°ä»£é£æ ¼
â”‚       â”‚   â”‚
â”‚       â”‚   â”œâ”€â”€ pages/           # é¡µé¢ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ hooks/           # React Hooks
â”‚       â”‚   â”œâ”€â”€ styles/          # æ ·å¼æ–‡ä»¶
â”‚       â”‚   â”œâ”€â”€ App.tsx
â”‚       â”‚   â””â”€â”€ main.tsx
â”‚       â”‚
â”‚       â”œâ”€â”€ public/              # é™æ€èµ„æº
â”‚       â”œâ”€â”€ resources -> ../../resources  # æ¸¸æˆèµ„æºï¼ˆç¬¦å·é“¾æ¥ï¼‰
â”‚       â”œâ”€â”€ index.html
â”‚       â”œâ”€â”€ package.json
â”‚       â”œâ”€â”€ tsconfig.json
â”‚       â””â”€â”€ vite.config.ts
â”‚
â”œâ”€â”€ resources/                   # æ¸¸æˆèµ„æº
â”‚   â”œâ”€â”€ map/                     # åœ°å›¾æ–‡ä»¶ (.map)
â”‚   â”œâ”€â”€ asf/                     # ç²¾çµåŠ¨ç”» (.asf)
â”‚   â”œâ”€â”€ mpc/                     # èµ„æºåŒ… (.mpc)
â”‚   â”œâ”€â”€ ini/                     # é…ç½®æ–‡ä»¶ (.ini)
â”‚   â”œâ”€â”€ script/                  # æ¸¸æˆå‰§æœ¬ (.txt)
â”‚   â”œâ”€â”€ save/                    # å­˜æ¡£ç›®å½•
â”‚   â””â”€â”€ Content/                 # åª’ä½“èµ„æº
â”‚       â”œâ”€â”€ music/               # èƒŒæ™¯éŸ³ä¹ (.ogg)
â”‚       â”œâ”€â”€ sound/               # éŸ³æ•ˆæ–‡ä»¶ (.ogg)
â”‚       â””â”€â”€ video/               # è§†é¢‘æ–‡ä»¶
â”‚
â”œâ”€â”€ scripts/                     # å·¥å…·è„šæœ¬
â”œâ”€â”€ docs/                        # æ–‡æ¡£
â”œâ”€â”€ JxqyHD/                      # C# å‚è€ƒä»£ç 
â”‚
â”œâ”€â”€ pnpm-workspace.yaml          # pnpm å·¥ä½œåŒºé…ç½®
â”œâ”€â”€ package.json                 # æ ¹ package.json
â””â”€â”€ biome.json                   # ä»£ç é£æ ¼é…ç½®
```
â”‚   â”‚   â”‚   â”œâ”€â”€ inputHandler.ts  # è¾“å…¥å¤„ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ interactionManager.ts  # äº¤äº’ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ magicHandler.ts  # æ­¦åŠŸå¤„ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ specialActionHandler.ts  # ç‰¹æ®ŠåŠ¨ä½œ
â”‚   â”‚   â”‚   â”œâ”€â”€ cameraController.ts    # é•œå¤´æ§åˆ¶
â”‚   â”‚   â”‚   â”œâ”€â”€ collisionChecker.ts    # ç¢°æ’æ£€æµ‹
â”‚   â”‚   â”‚   â”œâ”€â”€ mapTrapManager.ts      # åœ°å›¾é™·é˜±
â”‚   â”‚   â”‚   â”œâ”€â”€ loader.ts        # å­˜æ¡£åŠ è½½å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ storage.ts       # å­˜æ¡£å­˜å‚¨
â”‚   â”‚   â”‚   â””â”€â”€ scriptContextFactory.ts  # è„šæœ¬ä¸Šä¸‹æ–‡ï¼ˆ130+ æ–¹æ³•ï¼‰
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ resource/            # èµ„æºç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ globalResourceManager.ts  # å…¨å±€èµ„æº
â”‚   â”‚   â”‚   â”œâ”€â”€ resourceLoader.ts # ç»Ÿä¸€èµ„æºåŠ è½½å™¨ï¼ˆç¼“å­˜+å»é‡ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ mpc.ts           # MPC èµ„æºåŒ…è§£æ
â”‚   â”‚   â”‚   â””â”€â”€ resFile.ts       # èµ„æºæ–‡ä»¶è§£æ
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ map/                 # åœ°å›¾ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ map.ts           # åœ°å›¾è§£æ
â”‚   â”‚   â”‚   â”œâ”€â”€ renderer.ts      # åœ°å›¾æ¸²æŸ“
â”‚   â”‚   â”‚   â””â”€â”€ mapTrapManager.ts # é™·é˜±ç®¡ç†
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ sprite/              # ç²¾çµç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ sprite.ts        # ç²¾çµç±»ï¼ˆçŠ¶æ€ç€è‰²ï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ asf.ts           # ASF åŠ¨ç”»åŠ è½½
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ character/           # è§’è‰²ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ character.ts     # è§’è‰²åŸºç±»
â”‚   â”‚   â”‚   â”œâ”€â”€ npc.ts           # NPC
â”‚   â”‚   â”‚   â”œâ”€â”€ npcManager.ts    # NPC ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ iniParser.ts     # INI é…ç½®è§£æ
â”‚   â”‚   â”‚   â”œâ”€â”€ resFile.ts       # èµ„æºæ–‡ä»¶è§£æ
â”‚   â”‚   â”‚   â””â”€â”€ level/           # ç­‰çº§ç³»ç»Ÿ
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ player/              # ç©å®¶ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ player.ts        # ç©å®¶è§’è‰²
â”‚   â”‚   â”‚   â”œâ”€â”€ goods/           # ç‰©å“ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ good.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ goodsListManager.ts
â”‚   â”‚   â”‚   â””â”€â”€ magic/           # ç©å®¶æ­¦åŠŸ
â”‚   â”‚   â”‚       â””â”€â”€ magicListManager.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ script/              # å‰§æœ¬ç³»ç»Ÿï¼ˆ3000+ è¡Œï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ parser.ts        # è§£æå™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ executor.ts      # æ‰§è¡Œå™¨
â”‚   â”‚   â”‚   â””â”€â”€ commands/        # å‘½ä»¤å¤„ç†å™¨ï¼ˆ180+ å‘½ä»¤ï¼‰
â”‚   â”‚   â”‚       â”œâ”€â”€ types.ts      # ScriptContext æ¥å£ï¼ˆ130+ æ–¹æ³•ï¼‰
â”‚   â”‚   â”‚       â”œâ”€â”€ dialogCommands.ts    # å¯¹è¯å‘½ä»¤
â”‚   â”‚   â”‚       â”œâ”€â”€ npcCommands.ts       # NPC å‘½ä»¤
â”‚   â”‚   â”‚       â”œâ”€â”€ playerCommands.ts    # ç©å®¶å‘½ä»¤
â”‚   â”‚   â”‚       â”œâ”€â”€ gameStateCommands.ts # æ¸¸æˆçŠ¶æ€å‘½ä»¤
â”‚   â”‚   â”‚       â””â”€â”€ miscCommands.ts      # æ‚é¡¹å‘½ä»¤ï¼ˆå•†å“/é•œå¤´/å­˜æ¡£/å˜é‡/ç‰¹æ•ˆï¼‰
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ magic/               # æ­¦åŠŸç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ magicManager.ts  # æ­¦åŠŸé€»è¾‘ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ magicSprite.ts   # æ­¦åŠŸç²¾çµ
â”‚   â”‚   â”‚   â”œâ”€â”€ magicRenderer.ts # æ­¦åŠŸæ¸²æŸ“
â”‚   â”‚   â”‚   â”œâ”€â”€ magicLoader.ts   # æ­¦åŠŸé…ç½®åŠ è½½
â”‚   â”‚   â”‚   â”œâ”€â”€ magicUtils.ts    # å·¥å…·å‡½æ•°
â”‚   â”‚   â”‚   â”œâ”€â”€ types.ts         # ç±»å‹å®šä¹‰ï¼ˆMoveKind/SpecialKindï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ effects/         # æ­¦åŠŸç‰¹æ•ˆï¼ˆ12 ç§ MoveKindï¼‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ normalAttack.ts    # æ™®é€šé£è¡Œæ”»å‡»
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ throw.ts           # æŠ•æ·
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ followCharacter.ts # è·Ÿéšè§’è‰²ï¼ˆBUFFï¼‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ followEnemy.ts     # è¿½è¸ªæ•Œäºº
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ fixedPosition.ts   # å›ºå®šä½ç½®
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ regionBased.ts     # åŒºåŸŸæ”»å‡»
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ superMode.ts       # å…¨å±æ”»å‡»
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ specialMoveKinds.ts # ç‰¹æ®Šç±»å‹ï¼ˆä¼ é€/å¬å”¤/æ§åˆ¶ï¼‰
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ registry.ts        # ç‰¹æ•ˆæ³¨å†Œè¡¨
â”‚   â”‚   â”‚   â””â”€â”€ passives/        # è¢«åŠ¨æ•ˆæœ
â”‚   â”‚   â”‚       â”œâ”€â”€ passiveManager.ts
â”‚   â”‚   â”‚       â””â”€â”€ xiuLianEffect.ts   # ä¿®ç‚¼æ•ˆæœ
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ obj/                 # ç‰©ä½“ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ obj.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ objManager.ts
â”‚   â”‚   â”‚   â””â”€â”€ objRenderer.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ gui/                 # ç•Œé¢çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ guiManager.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ buyManager.ts    # å•†åº—ç®¡ç†å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ fonts.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ uiSettings.ts
â”‚   â”‚   â”‚   â””â”€â”€ uiConfig.ts      # UI é…ç½®
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ audio/               # éŸ³æ•ˆç³»ç»Ÿ
â”‚   â”‚   â”‚   â””â”€â”€ audioManager.ts  # Web Audio API å®ç°
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ effects/             # å±å¹•ç‰¹æ•ˆç³»ç»Ÿ
â”‚   â”‚   â”‚   â””â”€â”€ screenEffects.ts # æ·¡å…¥æ·¡å‡º/é¢œè‰²æ¸²æŸ“/é—ªå±/æ°´æ³¢çº¹
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ weather/             # å¤©æ°”ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ weatherManager.ts # å¤©æ°”ç®¡ç†å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ rain.ts          # é›¨ï¼ˆå«é—ªç”µï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ raindrop.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ snow.ts          # é›ª
â”‚   â”‚   â”‚   â””â”€â”€ snowflake.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ timer/               # è®¡æ—¶å™¨ç³»ç»Ÿ
â”‚   â”‚   â”‚   â””â”€â”€ timerManager.ts  # é™æ—¶ä»»åŠ¡
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ listManager/         # åˆ—è¡¨ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ memoListManager.ts   # ä»»åŠ¡è®°å½•
â”‚   â”‚   â”‚   â”œâ”€â”€ talkTextList.ts      # å¯¹è¯æ–‡æœ¬
â”‚   â”‚   â”‚   â””â”€â”€ partnerList.ts       # ä¼™ä¼´åå•
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ utils/               # å·¥å…·æ¨¡å—
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ debug/               # è°ƒè¯•ç³»ç»Ÿ
â”‚   â”‚       â””â”€â”€ debugManager.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ components/              # React ç»„ä»¶ï¼ˆ~12k è¡Œï¼‰
â”‚   â”‚   â”œâ”€â”€ game/                # æ¸¸æˆæ ¸å¿ƒç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Game.tsx         # æ¸¸æˆä¸»ç»„ä»¶ï¼ˆCanvas + UIï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ GameCanvas.tsx   # Canvas æ¸²æŸ“
â”‚   â”‚   â”‚   â”œâ”€â”€ GameUI.tsx       # æ¸¸æˆå†… UI å±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ LoadingOverlay.tsx
â”‚   â”‚   â”‚   â””â”€â”€ MapViewer.tsx    # åœ°å›¾æŸ¥çœ‹å™¨ï¼ˆå¼€å‘å·¥å…·ï¼‰
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ game/ui/             # UI ç»„ä»¶ï¼ˆ29 ä¸ªï¼‰
â”‚   â”‚       â”œâ”€â”€ DialogUI.tsx     # å¯¹è¯æ¡†
â”‚   â”‚       â”œâ”€â”€ SelectionUI.tsx  # é€‰é¡¹èœå•
â”‚   â”‚       â”œâ”€â”€ SelectionMultipleUI.tsx # å¤šé€‰èœå•
â”‚   â”‚       â”œâ”€â”€ GoodsGui.tsx     # ç‰©å“æ 
â”‚   â”‚       â”œâ”€â”€ EquipGui.tsx     # è£…å¤‡ç•Œé¢
â”‚   â”‚       â”œâ”€â”€ NpcEquipGui.tsx  # NPC è£…å¤‡
â”‚   â”‚       â”œâ”€â”€ MagicGui.tsx     # æ­¦åŠŸç•Œé¢
â”‚   â”‚       â”œâ”€â”€ StateGui.tsx     # çŠ¶æ€ç•Œé¢
â”‚   â”‚       â”œâ”€â”€ MemoGui.tsx      # ä»»åŠ¡è®°å½•
â”‚   â”‚       â”œâ”€â”€ XiuLianGui.tsx   # ä¿®ç‚¼ç•Œé¢
â”‚   â”‚       â”œâ”€â”€ BuyGui.tsx       # å•†åº—ç•Œé¢
â”‚   â”‚       â”œâ”€â”€ LittleMapGui.tsx # å°åœ°å›¾
â”‚   â”‚       â”œâ”€â”€ SystemGui.tsx    # ç³»ç»Ÿèœå•
â”‚   â”‚       â”œâ”€â”€ SaveLoadGui.tsx  # å­˜è¯»æ¡£ç•Œé¢
â”‚   â”‚       â”œâ”€â”€ TopGui.tsx       # é¡¶éƒ¨çŠ¶æ€æ 
â”‚   â”‚       â”œâ”€â”€ BottomGui.tsx    # åº•éƒ¨å¿«æ·æ 
â”‚   â”‚       â”œâ”€â”€ BottomStateGui.tsx # åº•éƒ¨çŠ¶æ€
â”‚   â”‚       â”œâ”€â”€ SidePanel.tsx    # ä¾§è¾¹é¢æ¿
â”‚   â”‚       â”œâ”€â”€ MessageGui.tsx   # æ¶ˆæ¯æç¤º
â”‚   â”‚       â”œâ”€â”€ NpcLifeBar.tsx   # NPC è¡€æ¡
â”‚   â”‚       â”œâ”€â”€ GameCursor.tsx   # æ¸¸æˆå…‰æ ‡
â”‚   â”‚       â”œâ”€â”€ ItemTooltip.tsx  # ç‰©å“æç¤º
â”‚   â”‚       â”œâ”€â”€ MagicTooltip.tsx # æ­¦åŠŸæç¤º
â”‚   â”‚       â”œâ”€â”€ TimerGui.tsx     # è®¡æ—¶å™¨æ˜¾ç¤º
â”‚   â”‚       â”œâ”€â”€ VideoPlayer.tsx  # è§†é¢‘æ’­æ”¾å™¨
â”‚   â”‚       â”œâ”€â”€ TitleGui.tsx     # æ ‡é¢˜ç•Œé¢
â”‚   â”‚       â”œâ”€â”€ TitleSettingsModal.tsx # è®¾ç½®å¼¹çª—
â”‚   â”‚       â”œâ”€â”€ AsfAnimatedSprite.tsx # ASF åŠ¨ç”»ç»„ä»¶
â”‚   â”‚       â”œâ”€â”€ ScrollBar.tsx    # æ»šåŠ¨æ¡
â”‚   â”‚       â””â”€â”€ DebugPanel/      # è°ƒè¯•é¢æ¿ï¼ˆæ¨¡å—åŒ–ï¼Œ10 ä¸ªåŒºå—ï¼‰
â”‚   â”‚           â”œâ”€â”€ DebugPanel.tsx
â”‚   â”‚           â”œâ”€â”€ sections/    # å„åŒºå—ç»„ä»¶
â”‚   â”‚           â”‚   â”œâ”€â”€ CharacterSection.tsx
â”‚   â”‚           â”‚   â”œâ”€â”€ MapSection.tsx
â”‚   â”‚           â”‚   â”œâ”€â”€ ScriptSection.tsx
â”‚   â”‚           â”‚   â”œâ”€â”€ ScriptHistorySection.tsx
â”‚   â”‚           â”‚   â”œâ”€â”€ ScriptExecuteSection.tsx
â”‚   â”‚           â”‚   â”œâ”€â”€ VariablesSection.tsx
â”‚   â”‚           â”‚   â”œâ”€â”€ ItemMagicSection.tsx
â”‚   â”‚           â”‚   â”œâ”€â”€ ResourceSection.tsx
â”‚   â”‚           â”‚   â”œâ”€â”€ XiuLianSection.tsx
â”‚   â”‚           â”‚   â””â”€â”€ QuickActionsSection.tsx
â”‚   â”‚           â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ pages/                   # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ GameScreen.tsx       # æ¸¸æˆä¸»é¡µé¢
â”‚   â”‚   â”œâ”€â”€ TitleScreen.tsx      # æ ‡é¢˜é¡µé¢
â”‚   â”‚   â”œâ”€â”€ MapViewerScreen.tsx  # åœ°å›¾æŸ¥çœ‹å™¨
â”‚   â”‚   â”œâ”€â”€ NotFoundPage.tsx     # 404 é¡µé¢
â”‚   â”‚   â””â”€â”€ landing/             # è½åœ°é¡µï¼ˆ13 ä¸ªç»„ä»¶ï¼‰
â”‚   â”‚       â”œâ”€â”€ LandingPage.tsx
â”‚   â”‚       â”œâ”€â”€ Hero.tsx
â”‚   â”‚       â”œâ”€â”€ Features.tsx
â”‚   â”‚       â”œâ”€â”€ TechStack.tsx
â”‚   â”‚       â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ hooks/                   # React Hooks
â”‚   â”‚   â””â”€â”€ useGameEngine.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ styles/                  # æ ·å¼æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ index.css
â”‚   â”‚
â”‚   â”œâ”€â”€ constants/               # å¸¸é‡å®šä¹‰
â”‚   â”‚
â”‚   â”œâ”€â”€ App.tsx                  # åº”ç”¨å…¥å£ï¼ˆé¡µé¢è·¯ç”±ï¼‰
â”‚   â””â”€â”€ main.tsx                 # ä¸»å…¥å£
â”‚
â”œâ”€â”€ resources/                   # æ¸¸æˆèµ„æº
â”‚   â”œâ”€â”€ map/                     # åœ°å›¾æ–‡ä»¶ (.map)
â”‚   â”œâ”€â”€ asf/                     # ç²¾çµåŠ¨ç”» (.asf)
â”‚   â”œâ”€â”€ mpc/                     # èµ„æºåŒ… (.mpc)
â”‚   â”œâ”€â”€ ini/                     # é…ç½®æ–‡ä»¶ (.ini)
â”‚   â”œâ”€â”€ script/                  # æ¸¸æˆå‰§æœ¬ (.txt)
â”‚   â”œâ”€â”€ save/                    # å­˜æ¡£ç›®å½•
â”‚   â””â”€â”€ Content/                 # åª’ä½“èµ„æº
â”‚       â”œâ”€â”€ music/               # èƒŒæ™¯éŸ³ä¹ (.ogg)
â”‚       â”œâ”€â”€ sound/               # éŸ³æ•ˆæ–‡ä»¶ (.ogg)
â”‚       â””â”€â”€ video/               # è§†é¢‘æ–‡ä»¶
â”‚
â”œâ”€â”€ scripts/                     # å·¥å…·è„šæœ¬
â”‚   â”œâ”€â”€ convert-encoding.sh      # æ–‡æœ¬ç¼–ç è½¬æ¢ (GBK â†’ UTF-8)
â”‚   â””â”€â”€ convert-sound.py         # éŸ³æ•ˆè½¬æ¢ (XNB â†’ OGG)
â”‚
â”œâ”€â”€ docs/                        # æ–‡æ¡£å’Œæˆªå›¾
â”‚
â””â”€â”€ JxqyHD/                      # C# å‚è€ƒä»£ç 
    â””â”€â”€ Engine/                  # å¼•æ“æºç å‚è€ƒ
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **Node.js** 18+
- **pnpm** 9+ï¼ˆå¿…é¡»ï¼‰
- æ”¯æŒ WebGL å’Œ Web Audio API çš„ç°ä»£æµè§ˆå™¨

### å®‰è£…è¿è¡Œ

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/patchoulib/game-jxqy.git
cd game-jxqy

# å®‰è£…ä¾èµ–ï¼ˆpnpm monorepoï¼‰
pnpm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
pnpm dev

# æ‰“å¼€æµè§ˆå™¨è®¿é—® http://localhost:5173
```

### æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
pnpm build
pnpm preview
```

### å¸¸ç”¨å‘½ä»¤

```bash
pnpm dev        # å¯åŠ¨å¼€å‘æœåŠ¡å™¨
pnpm build      # æ„å»ºç”Ÿäº§ç‰ˆæœ¬
pnpm tsc        # TypeScript ç±»å‹æ£€æŸ¥
pnpm lint       # ä»£ç æ£€æŸ¥
pnpm format     # ä»£ç æ ¼å¼åŒ–
```

---

## ğŸ® æ“ä½œæŒ‡å—

### é”®ç›˜æ§åˆ¶

| æŒ‰é”® | åŠŸèƒ½ |
|------|------|
| `æ–¹å‘é”®` / ç‚¹å‡»åœ°é¢ | ç§»åŠ¨ |
| `Shift` + ç§»åŠ¨ | å¥”è·‘ |
| `Space` / `Enter` | ä¸ NPC äº¤äº’ / ç¡®è®¤å¯¹è¯ |
| `Esc` | å–æ¶ˆ / å…³é—­èœå• / ç³»ç»Ÿèœå• |
| `1` - `9` | ä½¿ç”¨å¿«æ·æ æ­¦åŠŸ |

### é¼ æ ‡æ§åˆ¶

| æ“ä½œ | åŠŸèƒ½ |
|------|------|
| å·¦é”®ç‚¹å‡»åœ°é¢ | ç§»åŠ¨åˆ°ä½ç½® |
| å·¦é”®ç‚¹å‡» NPC/ç‰©ä½“ | äº¤äº’ |
| å³é”®ç‚¹å‡» NPC/ç‰©ä½“ | ä½¿ç”¨å¤‡ç”¨è„šæœ¬ |

### ğŸ“± ç§»åŠ¨ç«¯è§¦æ§

| æ“ä½œ | åŠŸèƒ½ |
|------|------|
| è™šæ‹Ÿæ‘‡æ†ï¼ˆå·¦ä¸‹è§’ï¼‰ | æ§åˆ¶è§’è‰²ç§»åŠ¨æ–¹å‘ |
| è½»è§¦å±å¹• | ä¸ NPC/ç‰©ä½“äº¤äº’ |
| åº•éƒ¨å¿«æ·æ  | ä½¿ç”¨æ­¦åŠŸæŠ€èƒ½ |
| å³ä¾§åŠŸèƒ½æŒ‰é’® | æ‰“å¼€èƒŒåŒ…/æ­¦åŠŸ/è£…å¤‡ç­‰ç•Œé¢ |

---

## ğŸ’» å¼€å‘æŒ‡å—

### é¡¹ç›®å‘½ä»¤

```bash
pnpm dev          # å¯åŠ¨å¼€å‘æœåŠ¡å™¨
pnpm build        # æ„å»ºç”Ÿäº§ç‰ˆæœ¬
pnpm preview      # é¢„è§ˆç”Ÿäº§ç‰ˆæœ¬
pnpm tsc          # TypeScript ç±»å‹æ£€æŸ¥
pnpm lint         # ä»£ç æ£€æŸ¥
```

### å¼€å‘åŸåˆ™

1. **ä¸¥æ ¼éµå¾ª C# æ¶æ„** - æ‰€æœ‰æ–°åŠŸèƒ½å¿…é¡»å…ˆæŸ¥çœ‹ `/JxqyHD/Engine/` ä¸­çš„å¯¹åº”å®ç°
2. **é€šè¿‡å¼•æ“è®¿é—®** - æ‰€æœ‰å­ç³»ç»Ÿè®¿é—®éƒ½é€šè¿‡ `GameEngine`ï¼Œä¸åˆ›å»ºç‹¬ç«‹çš„å…¨å±€å•ä¾‹
3. **ä¿æŒç±»å‹å®‰å…¨** - ä½¿ç”¨ TypeScript strict modeï¼Œé¿å… `any`
4. **äº‹ä»¶é©±åŠ¨é€šä¿¡** - å¼•æ“ä¸ UI é€šè¿‡äº‹ä»¶é€šä¿¡ï¼Œä¿æŒè§£è€¦

### èµ„æºæ–‡ä»¶æ ¼å¼

| æ ¼å¼ | è¯´æ˜ | ç¼–ç  | ä½ç½® |
|------|------|------|------|
| `.map` | åœ°å›¾æ•°æ®ï¼ˆç“¦ç‰‡ã€ç¢°æ’ï¼‰ | äºŒè¿›åˆ¶ | `/resources/map/` |
| `.asf` | ç²¾çµåŠ¨ç”»å¸§ | äºŒè¿›åˆ¶ | `/resources/asf/` |
| `.mpc` | å‹ç¼©èµ„æºåŒ… | äºŒè¿›åˆ¶ | `/resources/mpc/` |
| `.obj` | ç‰©ä½“å­˜æ¡£æ–‡ä»¶ | GBK | `/resources/ini/save/` |
| `.npc` | NPC å­˜æ¡£æ–‡ä»¶ | UTF-8 | `/resources/ini/save/` |
| `.ini` | é…ç½®æ–‡ä»¶ï¼ˆNPCã€ç‰©å“ç­‰ï¼‰ | UTF-8 | `/resources/ini/` |
| `.txt` | æ¸¸æˆå‰§æœ¬ | UTF-8 | `/resources/script/` |
| `.ogg` | éŸ³é¢‘æ–‡ä»¶ï¼ˆéŸ³ä¹å’ŒéŸ³æ•ˆï¼‰ | äºŒè¿›åˆ¶ | `/resources/Content/` |

### èµ„æºåŠ è½½æ¶æ„

æ‰€æœ‰èµ„æºåŠ è½½éƒ½é€šè¿‡ `resourceLoader` ç»Ÿä¸€ç®¡ç†ï¼š

```typescript
import { resourceLoader } from "../resource/resourceLoader";

// æ–‡æœ¬èµ„æºï¼ˆUTF-8ï¼‰
const content = await resourceLoader.loadText("/resources/script/xxx.txt");

// äºŒè¿›åˆ¶èµ„æºï¼ˆ.map, .asf, .mpc, éŸ³é¢‘ï¼‰
const buffer = await resourceLoader.loadBinary("/resources/map/xxx.map");

// è·å–åŠ è½½ç»Ÿè®¡ï¼ˆåœ¨è°ƒè¯•é¢æ¿æ˜¾ç¤ºï¼‰
const stats = resourceLoader.getStats();
```

**ç‰¹æ€§ï¼š**
- **ç¼“å­˜**ï¼šæ¯ä¸ªèµ„æºåªåŠ è½½ä¸€æ¬¡ï¼Œåç»­è¯·æ±‚ç›´æ¥è¿”å›ç¼“å­˜
- **å»é‡**ï¼šå¹¶å‘è¯·æ±‚åŒä¸€èµ„æºæ—¶ï¼Œåªå‘èµ·ä¸€æ¬¡ç½‘ç»œè¯·æ±‚
- **ç»Ÿè®¡**ï¼šè·Ÿè¸ªè¯·æ±‚æ¬¡æ•°ã€å‘½ä¸­ç‡ã€å¤±è´¥æ¬¡æ•°ï¼ˆè°ƒè¯•é¢æ¿å¯è§ï¼‰

### å·¥å…·è„šæœ¬

```bash
# è½¬æ¢æ–‡æœ¬ç¼–ç  (GBK â†’ UTF-8)
./scripts/convert-encoding.sh

# è½¬æ¢éŸ³æ•ˆæ–‡ä»¶ (XNB â†’ OGGï¼Œå°å†™æ–‡ä»¶å)
python3 scripts/convert-sound.py
```

è¯¦ç»†å¼€å‘æŒ‡å—è¯·å‚é˜… [.github/copilot-instructions.md](.github/copilot-instructions.md)

---

## ğŸ—ºï¸ å¼€å‘è·¯çº¿

### ç¬¬ä¸€é˜¶æ®µï¼šæ ¸å¿ƒåŸºç¡€ âœ…
- [x] åœ°å›¾æ¸²æŸ“ç³»ç»Ÿ
- [x] è§’è‰²ç§»åŠ¨å’ŒåŠ¨ç”»
- [x] å‰§æœ¬ç³»ç»Ÿï¼ˆ180+ å‘½ä»¤ï¼‰
- [x] åŸºç¡€ç•Œé¢ï¼ˆ29 ä¸ª UI ç»„ä»¶ï¼‰
- [x] æ“ä½œæ§åˆ¶
- [x] éŸ³æ•ˆç³»ç»Ÿï¼ˆWeb Audio API + OGGï¼‰
- [x] æ¶æ„é‡æ„ï¼ˆGameEngine å•ä¾‹å…¥å£ï¼‰

### ç¬¬äºŒé˜¶æ®µï¼šæ¸¸æˆæœºåˆ¶ âœ…
- [x] æ­¦åŠŸæŠ€èƒ½ï¼ˆ12 ç§ MoveKind ç‰¹æ•ˆï¼‰
- [x] æˆ˜æ–—ç³»ç»Ÿï¼ˆåŸºç¡€å®Œæˆï¼‰
- [x] èƒŒåŒ…ç‰©å“
- [x] è£…å¤‡ç³»ç»Ÿ
- [x] å­˜æ¡£/è¯»æ¡£
- [x] å•†åº—äº¤æ˜“ï¼ˆBuyManager + BuyGuiï¼‰
- [x] å°åœ°å›¾ï¼ˆLittleMapGuiï¼‰
- [x] å¤©æ°”ç³»ç»Ÿï¼ˆé›¨/é›ª/é—ªç”µï¼‰
- [x] è®¡æ—¶å™¨ç³»ç»Ÿï¼ˆé™æ—¶ä»»åŠ¡ï¼‰
- [x] è§†é¢‘æ’­æ”¾ï¼ˆHTML5 Videoï¼‰
- [x] ä¼™ä¼´ç³»ç»Ÿï¼ˆPartnerListï¼‰

### ç¬¬ä¸‰é˜¶æ®µï¼šå®Œå–„åŠŸèƒ½ï¼ˆè¿›è¡Œä¸­ï¼‰
- [x] é«˜çº§å¯»è·¯ (A*)
- [x] çŠ¶æ€æ•ˆæœæ¸²æŸ“ï¼ˆçŸ³åŒ–/å†»ç»“/ä¸­æ¯’ç€è‰²ï¼‰
- [x] å±å¹•ç‰¹æ•ˆï¼ˆæ·¡å…¥æ·¡å‡º/é¢œè‰²æ¸²æŸ“/æ°´æ³¢çº¹ï¼‰
- [ ] NPC AI ä¼˜åŒ–
- [ ] ä»»åŠ¡ç³»ç»Ÿå®Œå–„

### ç¬¬å››é˜¶æ®µï¼šä¼˜åŒ–ä¸æ‰©å±•
- [ ] æ€§èƒ½ä¼˜åŒ–
- [x] ç§»åŠ¨ç«¯æ”¯æŒï¼ˆè™šæ‹Ÿæ‘‡æ† + è§¦æ§äº¤äº’ + å“åº”å¼ UIï¼‰
- [ ] æ‰‹æŸ„æ”¯æŒ
- [ ] è®¾ç½®èœå•å®Œå–„

---

## ğŸ¤ å‚ä¸è´¡çŒ®

æ¬¢è¿æäº¤ Bug ä¿®å¤ã€æ–°åŠŸèƒ½æˆ–æ–‡æ¡£æ”¹è¿›ï¼

### è´¡çŒ®æ­¥éª¤

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/new-feature`)
3. å‚è€ƒ [å¼€å‘æŒ‡å—](.github/copilot-instructions.md)
4. æäº¤æ›´æ”¹ (`git commit -m 'æ·»åŠ æ–°åŠŸèƒ½'`)
5. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/new-feature`)
6. æäº¤ Pull Request

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

**æ³¨æ„**ï¼šè¿™æ˜¯ä¸€ä¸ªå­¦ä¹ æ€§è´¨çš„ç²‰ä¸é¡¹ç›®ï¼Œæ¸¸æˆç´ æå’ŒçŸ¥è¯†äº§æƒå½’åŸä½œè€…æ‰€æœ‰ã€‚

---

## ğŸ™ è‡´è°¢

- **åŸä½œæ¸¸æˆ**ï¼šè¥¿å±±å±… (Kingsoft) - å‰‘ä¾ æƒ…ç¼˜å¤–ä¼ ï¼šæœˆå½±ä¼ è¯´ (2001)
- **C# å¤åˆ»é¡¹ç›®**ï¼š[mapic91/JxqyHD](https://github.com/mapic91/JxqyHD)
- **æŠ€æœ¯æ ˆ**ï¼šTypeScript, React 19, Vite 7, WebGL, Web Audio API

---

<div align="center">

**âš”ï¸ å‰‘æ°”çºµæ¨ªä¸‰ä¸‡é‡Œï¼Œä¸€å‰‘å…‰å¯’åä¹æ´² âš”ï¸**

*ç”¨ç°ä»£ Web æŠ€æœ¯é‡ç°ç»å…¸æ­¦ä¾ *

</div>
